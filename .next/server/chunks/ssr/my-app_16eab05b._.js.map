{"version":3,"sources":["turbopack:///[project]/my-app/utils/api.js","turbopack:///[project]/my-app/app/jobs/[id]/apply/page.jsx"],"sourcesContent":["const BASE_URL = \"http://127.0.0.1:8000\";\r\n\r\n// ------------------ USERS ------------------\r\n\r\n// Signup\r\nexport const signupUser = async (data) => {\r\n  const res = await fetch(`${BASE_URL}/api/users/create/`, {\r\n    method: \"POST\",\r\n    headers: { \"Content-Type\": \"application/json\" },\r\n    body: JSON.stringify(data),\r\n  });\r\n  return res.json();\r\n};\r\n\r\n// Login\r\nexport const loginUser = async (data) => {\r\n  const res = await fetch(`${BASE_URL}/api/token/`, {\r\n    method: \"POST\",\r\n    headers: { \"Content-Type\": \"application/json\" },\r\n    body: JSON.stringify(data),\r\n  });\r\n  return res.json();\r\n};\r\n\r\n// Get all users\r\nexport const getAllUsers = async () => {\r\n  const res = await fetch(`${BASE_URL}/api/users/all/`);\r\n  return res.json();\r\n};\r\n\r\n// Get single user\r\nexport const getUser = async (id) => {\r\n  const res = await fetch(`${BASE_URL}/api/users/${id}/`);\r\n  return res.json();\r\n};\r\n\r\n// ------------------ JOBS ------------------\r\n\r\n// Create a job\r\nexport const createJob = async (data, token) => {\r\n  const res = await fetch(`${BASE_URL}/api/jobs/create/`, {\r\n    method: \"POST\",\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n      Authorization: `Bearer ${token}`,\r\n    },\r\n    body: JSON.stringify(data),\r\n  });\r\n  return res.json();\r\n};\r\n\r\n// Get all jobs\r\nexport const getAllJobs = async () => {\r\n  const res = await fetch(`${BASE_URL}/api/jobs/all/`);\r\n  return res.json();\r\n};\r\n\r\n// Get single job\r\nexport const getJob = async (id) => {\r\n  const res = await fetch(`${BASE_URL}/api/jobs/${id}/`);\r\n  if (!res.ok) throw new Error(\"Failed to fetch job\");\r\n  return res.json();\r\n};\r\n\r\n// ------------------ APPLICATIONS ------------------\r\n\r\n// Apply for a job (public or logged-in)\r\nexport const createApplication = async (data, token) => {\r\n  const formData = new FormData();\r\n  formData.append(\"job\", data.job);\r\n  formData.append(\"cover_letter\", data.cover_letter);\r\n  if (data.resume) formData.append(\"resume\", data.resume);\r\n\r\n  const headers = {};\r\n  if (token) headers[\"Authorization\"] = `Bearer ${token}`;\r\n\r\n  const res = await fetch(`${BASE_URL}/api/applications/create/`, {\r\n    method: \"POST\",\r\n    headers,\r\n    body: formData,\r\n  });\r\n\r\n  let responseData;\r\n  try {\r\n    responseData = await res.json();\r\n  } catch (err) {\r\n    const text = await res.text();\r\n    console.error(\"Non-JSON response from server:\", text);\r\n    responseData = { error: \"Invalid JSON response from server\", raw: text };\r\n  }\r\n\r\n  if (!res.ok) throw responseData;\r\n  return responseData;\r\n};\r\n\r\n// Get all applications\r\nexport const getAllApplications = async () => {\r\n  const res = await fetch(`${BASE_URL}/api/applications/all/`);\r\n  return res.json();\r\n};\r\n\r\n// Get single application\r\nexport const getApplication = async (id) => {\r\n  const res = await fetch(`${BASE_URL}/api/applications/${id}/`);\r\n  return res.json();\r\n};\r\n\r\n// Update an application\r\nexport const updateApplication = async (id, data) => {\r\n  const formData = new FormData();\r\n  if (data.cover_letter) formData.append(\"cover_letter\", data.cover_letter);\r\n  if (data.resume) formData.append(\"resume\", data.resume);\r\n\r\n  const res = await fetch(`${BASE_URL}/api/applications/${id}/`, {\r\n    method: \"PUT\",\r\n    body: formData,\r\n  });\r\n\r\n  let responseData;\r\n  try {\r\n    responseData = await res.json();\r\n  } catch (err) {\r\n    const text = await res.text();\r\n    console.error(\"Non-JSON response from server:\", text);\r\n    responseData = { error: \"Invalid JSON response from server\", raw: text };\r\n  }\r\n\r\n  if (!res.ok) throw responseData;\r\n  return responseData;\r\n};\r\n\r\n// Delete an application\r\nexport const deleteApplication = async (id) => {\r\n  const res = await fetch(`${BASE_URL}/api/applications/${id}/`, {\r\n    method: \"DELETE\",\r\n  });\r\n  if (!res.ok) {\r\n    const text = await res.text();\r\n    throw { error: \"Failed to delete application\", raw: text };\r\n  }\r\n  return { message: \"Deleted successfully\" };\r\n};\r\n","\"use client\";\r\n\r\nimport { useParams, useRouter } from \"next/navigation\";\r\nimport { useState, useEffect } from \"react\";\r\nimport { getJob, createApplication } from \"@/utils/api\";\r\n\r\nexport default function ApplyPage() {\r\n  const { id } = useParams();\r\n  const router = useRouter();\r\n  const [job, setJob] = useState(null);\r\n  const [coverLetter, setCoverLetter] = useState(\"\");\r\n  const [resume, setResume] = useState(null);\r\n  const [loading, setLoading] = useState(false);\r\n  const [message, setMessage] = useState(\"\");\r\n\r\n  useEffect(() => {\r\n    const fetchJobDetails = async () => {\r\n      try {\r\n        const data = await getJob(id);\r\n        setJob(data);\r\n      } catch (error) {\r\n        console.error(\"Error fetching job:\", error);\r\n      }\r\n    };\r\n    if (id) fetchJobDetails();\r\n  }, [id]);\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    setLoading(true);\r\n    setMessage(\"\");\r\n\r\n    try {\r\n      await createApplication({ job: id, cover_letter: coverLetter, resume }, null); \r\n      setMessage(\"✅ Application submitted successfully!\");\r\n      setTimeout(() => router.push(\"/jobs\"), 2000);\r\n    } catch (err) {\r\n      console.error(\"Error submitting application:\", err);\r\n      setMessage(err.error || \"❌ Failed to submit application. Please try again.\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  if (!job) return <p className=\"text-center mt-20\">Loading job details...</p>;\r\n\r\n  return (\r\n    <section className=\"max-w-xl mx-auto py-12 px-6\">\r\n      <h1 className=\"text-3xl font-bold mb-6\">Apply for {job.title}</h1>\r\n      <form onSubmit={handleSubmit} className=\"space-y-5\">\r\n        <div>\r\n          <label className=\"block mb-1\">Cover Letter</label>\r\n          <textarea\r\n            value={coverLetter}\r\n            onChange={(e) => setCoverLetter(e.target.value)}\r\n            required\r\n            rows={5}\r\n            className=\"w-full border p-3 rounded-lg\"\r\n          />\r\n        </div>\r\n        <div>\r\n          <label className=\"block mb-1\">Upload Resume</label>\r\n          <input\r\n            type=\"file\"\r\n            onChange={(e) => setResume(e.target.files[0])}\r\n            required\r\n            className=\"w-full border p-2 rounded-lg\"\r\n          />\r\n        </div>\r\n        <button\r\n          type=\"submit\"\r\n          disabled={loading}\r\n          className=\"w-full bg-blue-600 text-white py-3 rounded-xl\"\r\n        >\r\n          {loading ? \"Submitting...\" : \"Submit Application\"}\r\n        </button>\r\n      </form>\r\n      {message && <p className=\"mt-4 text-center\">{message}</p>}\r\n    </section>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}